----------------------------
Running the insert-addcolumn-insert scenario
----------------------------
Ensuring the database is clean and ready...
Setting up test tables...
Adding example records...
Tables ready
Executing S1 query: INSERT INTO `test_table` (id,val) VALUES (5, 'anteater');
Executing S2 query: ALTER TABLE `test_table` ADD COLUMN val2 VARCHAR(255) DEFAULT NULL;
Executing S3 query: INSERT INTO `test_table` (id,val) VALUES (6, 'armadillo');
Rolling back S1...
Closing S1
Closing S2
Rolling back S3
Closing S3
Ensuring the database is clean and ready...
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| Object Type       | Object Schema   | Object Name   | Lock Type           | Lock Status   |   Owner Event ID |   Owner Thread ID |
+===================+=================+===============+=====================+===============+==================+===================+
| TABLE             | lock_test       | test_table    | SHARED              | GRANTED       |                1 |                28 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED              | PENDING       |                1 |                28 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               820 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED              | GRANTED       |                8 |               820 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| SCHEMA            | lock_test       |               | INTENTION_EXCLUSIVE | GRANTED       |                5 |               822 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | #sql-1_2ec    | EXCLUSIVE           | GRANTED       |                5 |               822 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | EXCLUSIVE           | PENDING       |                6 |               822 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_UPGRADABLE   | GRANTED       |                5 |               822 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| COLUMN STATISTICS | lock_test       | test_table    | SHARED_READ         | GRANTED       |                6 |               822 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| SCHEMA            | lock_test       |               | INTENTION_EXCLUSIVE | GRANTED       |                7 |               823 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | PENDING       |                7 |               823 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               823 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
----------------------------
Running the update-addcolumn-update scenario
----------------------------
Ensuring the database is clean and ready...
Setting up test tables...
Adding example records...
Tables ready
Executing S1 query: UPDATE `test_table` set val = 'panda' where id = 3;
Executing S2 query: ALTER TABLE `test_table` ADD COLUMN val2 VARCHAR(255) DEFAULT NULL;
Executing S3 query: UPDATE `test_table` set val = 'porcupine' where id = 2;
Rolling back S1...
Closing S1
Closing S2
Rolling back S3
Closing S3
Ensuring the database is clean and ready...
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| Object Type       | Object Schema   | Object Name   | Lock Type           | Lock Status   |   Owner Event ID |   Owner Thread ID |
+===================+=================+===============+=====================+===============+==================+===================+
| TABLE             | dummy_sdi_db    | SDI_166       | SHARED              | GRANTED       |                1 |                40 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               828 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| SCHEMA            | lock_test       |               | INTENTION_EXCLUSIVE | GRANTED       |                5 |               829 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | #sql-1_2f3    | EXCLUSIVE           | GRANTED       |                5 |               829 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| COLUMN STATISTICS | lock_test       | test_table    | SHARED_READ         | GRANTED       |                6 |               829 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | EXCLUSIVE           | PENDING       |                6 |               829 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_UPGRADABLE   | GRANTED       |                5 |               829 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | PENDING       |                7 |               830 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               830 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
----------------------------
Running the update-createtable-update scenario
----------------------------
Ensuring the database is clean and ready...
Setting up test tables...
Adding example records...
Tables ready
Executing S1 query: UPDATE `test_table` set val = 'panda' where id = 3;
Executing S2 query: CREATE TABLE `child` 
                (`id` int NOT NULL AUTO_INCREMENT,
                `test_table_id` int DEFAULT NULL,
                `val` varchar(10) DEFAULT NULL,
                PRIMARY KEY (`id`),
                CONSTRAINT `fk_test_table` FOREIGN KEY (`test_table_id`)
                REFERENCES `test_table` (`id`)
                ON DELETE CASCADE ON UPDATE NO ACTION );
Executing S3 query: UPDATE `test_table` set val = 'porcupine' where id = 2;
Rolling back S1...
Closing S1
Closing S2
Rolling back S3
Closing S3
Ensuring the database is clean and ready...
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| Object Type       | Object Schema   | Object Name   | Lock Type           | Lock Status   |   Owner Event ID |   Owner Thread ID |
+===================+=================+===============+=====================+===============+==================+===================+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               835 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| SCHEMA            | lock_test       |               | INTENTION_EXCLUSIVE | GRANTED       |                5 |               836 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | child         | SHARED              | GRANTED       |                5 |               836 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| FOREIGN KEY       | lock_test       | fk_test_table | EXCLUSIVE           | GRANTED       |                5 |               836 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | EXCLUSIVE           | PENDING       |                5 |               836 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | EXCLUSIVE           | GRANTED       |                5 |               836 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| SCHEMA            | lock_test       |               | INTENTION_EXCLUSIVE | GRANTED       |                7 |               837 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | child         | SHARED_READ         | GRANTED       |                7 |               837 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               837 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| COLUMN STATISTICS | lock_test       | test_table    | SHARED_READ         | GRANTED       |                7 |               837 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | PENDING       |                7 |               837 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
----------------------------
Running the insert-createtable-insert scenario
----------------------------
Ensuring the database is clean and ready...
Setting up test tables...
Adding example records...
Tables ready
Executing S1 query: INSERT INTO `test_table` (id,val) VALUES (5, 'anteater');
Executing S2 query: CREATE TABLE `child` 
                (`id` int NOT NULL AUTO_INCREMENT,
                `test_table_id` int DEFAULT NULL,
                `val` varchar(10) DEFAULT NULL,
                PRIMARY KEY (`id`),
                CONSTRAINT `fk_test_table` FOREIGN KEY (`test_table_id`)
                REFERENCES `test_table` (`id`)
                ON DELETE CASCADE ON UPDATE NO ACTION );
Executing S3 query: INSERT INTO `test_table` (id,val) VALUES (6, 'armadillo');
Rolling back S1...
Closing S1
Closing S2
Rolling back S3
Closing S3
Ensuring the database is clean and ready...
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| Object Type       | Object Schema   | Object Name   | Lock Type           | Lock Status   |   Owner Event ID |   Owner Thread ID |
+===================+=================+===============+=====================+===============+==================+===================+
| TABLE             | lock_test       | test_table    | SHARED              | GRANTED       |                1 |                28 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED              | PENDING       |                1 |                28 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               842 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| SCHEMA            | lock_test       |               | INTENTION_EXCLUSIVE | GRANTED       |                5 |               843 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | child         | SHARED              | GRANTED       |                5 |               843 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| FOREIGN KEY       | lock_test       | fk_test_table | EXCLUSIVE           | GRANTED       |                5 |               843 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | EXCLUSIVE           | PENDING       |                5 |               843 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | EXCLUSIVE           | GRANTED       |                5 |               843 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| SCHEMA            | lock_test       |               | INTENTION_EXCLUSIVE | GRANTED       |                7 |               844 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | PENDING       |                7 |               844 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| COLUMN STATISTICS | lock_test       | test_table    | SHARED_READ         | GRANTED       |                7 |               844 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               844 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
----------------------------
Running the update-addindex-update scenario
----------------------------
Ensuring the database is clean and ready...
Setting up test tables...
Adding example records...
Tables ready
Executing S1 query: UPDATE `test_table` set val = 'panda' where id = 3;
Executing S2 query: alter table `test_table` add index `idx_new` (val);
Executing S3 query: UPDATE `test_table` set val = 'porcupine' where id = 2;
Rolling back S1...
Closing S1
Rolling back S3
Closing S3
Closing S2
Ensuring the database is clean and ready...
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| Object Type       | Object Schema   | Object Name   | Lock Type           | Lock Status   |   Owner Event ID |   Owner Thread ID |
+===================+=================+===============+=====================+===============+==================+===================+
| TABLE             | lock_test       | test_table    | SHARED              | GRANTED       |                1 |                28 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED              | PENDING       |                1 |                28 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | dummy_sdi_db    | SDI_171       | SHARED              | GRANTED       |                1 |                38 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               848 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| SCHEMA            | lock_test       |               | INTENTION_EXCLUSIVE | GRANTED       |                5 |               850 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | #sql-1_308    | EXCLUSIVE           | GRANTED       |                5 |               850 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | EXCLUSIVE           | PENDING       |                5 |               850 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | EXCLUSIVE           | PENDING       |                6 |               850 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_UPGRADABLE   | GRANTED       |                5 |               850 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| COLUMN STATISTICS | lock_test       | test_table    | SHARED_READ         | GRANTED       |                6 |               850 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | PENDING       |                7 |               851 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               851 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
----------------------------
Running the insert-addindex-insert scenario
----------------------------
Ensuring the database is clean and ready...
Setting up test tables...
Adding example records...
Tables ready
Executing S1 query: INSERT INTO `test_table` (id,val) VALUES (5, 'anteater');
Executing S2 query: alter table `test_table` add index `idx_new` (val);
Executing S3 query: INSERT INTO `test_table` (id,val) VALUES (6, 'armadillo');
Rolling back S1...
Closing S1
Rolling back S3
Closing S3
Closing S2
Ensuring the database is clean and ready...
+---------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| Object Type   | Object Schema   | Object Name   | Lock Type           | Lock Status   |   Owner Event ID |   Owner Thread ID |
+===============+=================+===============+=====================+===============+==================+===================+
| TABLE         | lock_test       | test_table    | SHARED              | GRANTED       |                1 |                28 |
+---------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE         | lock_test       | test_table    | SHARED              | PENDING       |                1 |                28 |
+---------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE         | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               858 |
+---------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| SCHEMA        | lock_test       |               | INTENTION_EXCLUSIVE | GRANTED       |                5 |               860 |
+---------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE         | lock_test       | #sql-1_30f    | EXCLUSIVE           | GRANTED       |                5 |               860 |
+---------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE         | lock_test       | test_table    | EXCLUSIVE           | PENDING       |                5 |               860 |
+---------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE         | lock_test       | test_table    | EXCLUSIVE           | PENDING       |                6 |               860 |
+---------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE         | lock_test       | test_table    | SHARED_UPGRADABLE   | GRANTED       |                5 |               860 |
+---------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE         | lock_test       | test_table    | SHARED_WRITE        | PENDING       |                7 |               861 |
+---------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE         | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               861 |
+---------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
----------------------------
Running the insert-addcolumn-insert-with-parent scenario
----------------------------
Ensuring the database is clean and ready...
Setting up test tables...
Setting up parent table...
Setting up the main table...
Adding example records...
Tables ready
Executing S1 query: INSERT INTO `test_table` (id,val) VALUES (5, 'anteater');
Executing S2 query: ALTER TABLE `test_table` ADD COLUMN val2 VARCHAR(255) DEFAULT NULL;
Executing S3 query: INSERT INTO `test_table` (id,val) VALUES (6, 'armadillo');
Rolling back S1...
Closing S1
Closing S2
Rolling back S3
Closing S3
Ensuring the database is clean and ready...
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| Object Type       | Object Schema   | Object Name   | Lock Type           | Lock Status   |   Owner Event ID |   Owner Thread ID |
+===================+=================+===============+=====================+===============+==================+===================+
| TABLE             | lock_test       | parent        | SHARED              | GRANTED       |                1 |                28 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED              | PENDING       |                1 |                28 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | parent        | SHARED_READ         | GRANTED       |                7 |               873 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               873 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| SCHEMA            | lock_test       |               | INTENTION_EXCLUSIVE | GRANTED       |                5 |               874 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | #sql-1_316    | EXCLUSIVE           | GRANTED       |                5 |               874 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | parent        | SHARED_UPGRADABLE   | GRANTED       |                5 |               874 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| COLUMN STATISTICS | lock_test       | test_table    | SHARED_READ         | GRANTED       |                6 |               874 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | EXCLUSIVE           | PENDING       |                6 |               874 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_UPGRADABLE   | GRANTED       |                5 |               874 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | parent        | SHARED_READ         | GRANTED       |                7 |               875 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | PENDING       |                7 |               875 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               875 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
----------------------------
Running the update-addcolumn-update-with-parent scenario
----------------------------
Ensuring the database is clean and ready...
Setting up test tables...
Setting up parent table...
Setting up the main table...
Adding example records...
Tables ready
Executing S1 query: UPDATE `test_table` set val = 'panda' where id = 3;
Executing S2 query: ALTER TABLE `test_table` ADD COLUMN val2 VARCHAR(255) DEFAULT NULL;
Executing S3 query: UPDATE `test_table` set val = 'porcupine' where id = 2;
Rolling back S1...
Closing S1
Closing S2
Rolling back S3
Closing S3
Ensuring the database is clean and ready...
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| Object Type       | Object Schema   | Object Name   | Lock Type           | Lock Status   |   Owner Event ID |   Owner Thread ID |
+===================+=================+===============+=====================+===============+==================+===================+
| TABLE             | lock_test       | parent        | SHARED              | GRANTED       |                1 |                28 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED              | PENDING       |                1 |                28 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | parent        | SHARED_READ         | GRANTED       |                7 |               879 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               879 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| SCHEMA            | lock_test       |               | INTENTION_EXCLUSIVE | GRANTED       |                5 |               881 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | #sql-1_31d    | EXCLUSIVE           | GRANTED       |                5 |               881 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | parent        | SHARED_UPGRADABLE   | GRANTED       |                5 |               881 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | EXCLUSIVE           | PENDING       |                6 |               881 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_UPGRADABLE   | GRANTED       |                5 |               881 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| COLUMN STATISTICS | lock_test       | test_table    | SHARED_READ         | GRANTED       |                6 |               881 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | parent        | SHARED_READ         | GRANTED       |                7 |               882 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               882 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | PENDING       |                7 |               882 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
----------------------------
Running the update-createtable-update-with-parent scenario
----------------------------
Ensuring the database is clean and ready...
Setting up test tables...
Setting up parent table...
Setting up the main table...
Adding example records...
Tables ready
Executing S1 query: UPDATE `test_table` set val = 'panda' where id = 3;
Executing S2 query: CREATE TABLE `child` 
                (`id` int NOT NULL AUTO_INCREMENT,
                `test_table_id` int DEFAULT NULL,
                `val` varchar(10) DEFAULT NULL,
                PRIMARY KEY (`id`),
                CONSTRAINT `fk_test_table` FOREIGN KEY (`test_table_id`)
                REFERENCES `test_table` (`id`)
                ON DELETE CASCADE ON UPDATE NO ACTION );
Executing S3 query: UPDATE `test_table` set val = 'porcupine' where id = 2;
Rolling back S1...
Closing S1
Closing S2
Rolling back S3
Closing S3
Ensuring the database is clean and ready...
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| Object Type       | Object Schema   | Object Name   | Lock Type           | Lock Status   |   Owner Event ID |   Owner Thread ID |
+===================+=================+===============+=====================+===============+==================+===================+
| TABLE             | lock_test       | parent        | SHARED              | GRANTED       |                1 |                28 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED              | GRANTED       |                1 |                28 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED              | PENDING       |                1 |                28 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | parent        | SHARED_READ         | GRANTED       |                7 |               886 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               886 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| SCHEMA            | lock_test       |               | INTENTION_EXCLUSIVE | GRANTED       |                5 |               888 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | child         | SHARED              | GRANTED       |                5 |               888 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| FOREIGN KEY       | lock_test       | fk_test_table | EXCLUSIVE           | GRANTED       |                5 |               888 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | EXCLUSIVE           | PENDING       |                5 |               888 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | EXCLUSIVE           | GRANTED       |                5 |               888 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| SCHEMA            | lock_test       |               | INTENTION_EXCLUSIVE | GRANTED       |                7 |               889 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | child         | SHARED_READ         | GRANTED       |                7 |               889 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | parent        | SHARED_READ         | GRANTED       |                7 |               889 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | PENDING       |                7 |               889 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| COLUMN STATISTICS | lock_test       | test_table    | SHARED_READ         | GRANTED       |                7 |               889 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               889 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
----------------------------
Running the insert-createtable-insert-with-parent scenario
----------------------------
Ensuring the database is clean and ready...
Setting up test tables...
Setting up parent table...
Setting up the main table...
Adding example records...
Tables ready
Executing S1 query: INSERT INTO `test_table` (id,val) VALUES (5, 'anteater');
Executing S2 query: CREATE TABLE `child` 
                (`id` int NOT NULL AUTO_INCREMENT,
                `test_table_id` int DEFAULT NULL,
                `val` varchar(10) DEFAULT NULL,
                PRIMARY KEY (`id`),
                CONSTRAINT `fk_test_table` FOREIGN KEY (`test_table_id`)
                REFERENCES `test_table` (`id`)
                ON DELETE CASCADE ON UPDATE NO ACTION );
Executing S3 query: INSERT INTO `test_table` (id,val) VALUES (6, 'armadillo');
Rolling back S1...
Closing S1
Closing S2
Rolling back S3
Closing S3
Ensuring the database is clean and ready...
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| Object Type       | Object Schema   | Object Name   | Lock Type           | Lock Status   |   Owner Event ID |   Owner Thread ID |
+===================+=================+===============+=====================+===============+==================+===================+
| TABLE             | lock_test       | test_table    | SHARED              | GRANTED       |                1 |                28 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED              | PENDING       |                1 |                28 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | parent        | SHARED_READ         | GRANTED       |                7 |               894 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               894 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| SCHEMA            | lock_test       |               | INTENTION_EXCLUSIVE | GRANTED       |                5 |               895 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | child         | SHARED              | GRANTED       |                5 |               895 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| FOREIGN KEY       | lock_test       | fk_test_table | EXCLUSIVE           | GRANTED       |                5 |               895 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | EXCLUSIVE           | PENDING       |                5 |               895 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | EXCLUSIVE           | GRANTED       |                5 |               895 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| SCHEMA            | lock_test       |               | INTENTION_EXCLUSIVE | GRANTED       |                7 |               896 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | parent        | SHARED_READ         | GRANTED       |                7 |               896 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | PENDING       |                7 |               896 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| COLUMN STATISTICS | lock_test       | test_table    | SHARED_READ         | GRANTED       |                7 |               896 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               896 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
----------------------------
Running the update-addindex-update-with-parent scenario
----------------------------
Ensuring the database is clean and ready...
Setting up test tables...
Setting up parent table...
Setting up the main table...
Adding example records...
Tables ready
Executing S1 query: UPDATE `test_table` set val = 'panda' where id = 3;
Executing S2 query: alter table `test_table` add index `idx_new` (val);
Executing S3 query: UPDATE `test_table` set val = 'porcupine' where id = 2;
Rolling back S1...
Closing S1
Rolling back S3
Closing S3
Closing S2
Ensuring the database is clean and ready...
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| Object Type       | Object Schema   | Object Name   | Lock Type           | Lock Status   |   Owner Event ID |   Owner Thread ID |
+===================+=================+===============+=====================+===============+==================+===================+
| TABLE             | lock_test       | test_table    | SHARED              | PENDING       |                1 |                28 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED              | GRANTED       |                1 |                28 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | dummy_sdi_db    | SDI_184       | SHARED              | PENDING       |                1 |                38 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | parent        | SHARED_READ         | GRANTED       |                7 |               901 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               901 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| SCHEMA            | lock_test       |               | INTENTION_EXCLUSIVE | GRANTED       |                5 |               902 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | #sql-1_332    | EXCLUSIVE           | GRANTED       |                5 |               902 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | parent        | SHARED_UPGRADABLE   | GRANTED       |                5 |               902 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | EXCLUSIVE           | PENDING       |                5 |               902 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | EXCLUSIVE           | PENDING       |                6 |               902 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_UPGRADABLE   | GRANTED       |                5 |               902 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| COLUMN STATISTICS | lock_test       | test_table    | SHARED_READ         | GRANTED       |                6 |               902 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | parent        | SHARED_READ         | GRANTED       |                7 |               903 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | PENDING       |                7 |               903 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               903 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
----------------------------
Running the insert-addindex-insert-with-parent scenario
----------------------------
Ensuring the database is clean and ready...
Setting up test tables...
Setting up parent table...
Setting up the main table...
Adding example records...
Tables ready
Executing S1 query: INSERT INTO `test_table` (id,val) VALUES (5, 'anteater');
Executing S2 query: alter table `test_table` add index `idx_new` (val);
Executing S3 query: INSERT INTO `test_table` (id,val) VALUES (6, 'armadillo');
Rolling back S1...
Closing S1
Rolling back S3
Closing S3
Closing S2
Ensuring the database is clean and ready...
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| Object Type       | Object Schema   | Object Name   | Lock Type           | Lock Status   |   Owner Event ID |   Owner Thread ID |
+===================+=================+===============+=====================+===============+==================+===================+
| TABLE             | lock_test       | parent        | SHARED              | GRANTED       |                1 |                28 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED              | GRANTED       |                1 |                28 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED              | PENDING       |                1 |                28 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | parent        | SHARED_READ         | GRANTED       |                7 |               910 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               910 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED              | GRANTED       |                8 |               910 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| SCHEMA            | lock_test       |               | INTENTION_EXCLUSIVE | GRANTED       |                5 |               912 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | #sql-1_339    | EXCLUSIVE           | GRANTED       |                5 |               912 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | parent        | SHARED_UPGRADABLE   | GRANTED       |                5 |               912 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | EXCLUSIVE           | PENDING       |                5 |               912 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | EXCLUSIVE           | PENDING       |                6 |               912 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_UPGRADABLE   | GRANTED       |                5 |               912 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| COLUMN STATISTICS | lock_test       | test_table    | SHARED_READ         | GRANTED       |                6 |               912 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | parent        | SHARED_READ         | GRANTED       |                7 |               913 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | PENDING       |                7 |               913 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
| TABLE             | lock_test       | test_table    | SHARED_WRITE        | GRANTED       |                7 |               913 |
+-------------------+-----------------+---------------+---------------------+---------------+------------------+-------------------+
